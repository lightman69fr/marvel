var Personnages=function(a){var e="liste";switch(isDefined(a)&&isObject(a)&&a.hasOwnProperty("mode")&&isString(a.mode)&&(e=a.mode),e){default:this.getListPersonnages();break;case"liste":this.getListPersonnages();break;case"showPers":if(a.hasOwnProperty("persID")){var r=parseInt(a.persID);this.getPersonnage(r)}else alert("Aucun id de persnnage fourni")}};Personnages.prototype={getPersonnage:function(a){isDefined(a)&&isInt(a);var e=this,r="a16d8956cd76927ea53d489bba636c59",t=(new Date).getTime(),n="552f39f60cff390bd30671513415f1ba",i={offset:0,limit:100,orderBy:"onsaleDate"},o=this.generateUrlParams(i),v="http://gateway.marvel.com/v1/public/characters/"+a+"/comics?ts="+t+"&apikey="+r+"&hash="+n+"&"+o,l="http://gateway.marvel.com/v1/public/characters/"+a+"?ts="+t+"&apikey="+r+"&hash="+n,c="GET",h=null,p=null,u={page:l,methode:c,callback:function(a){var r=JSON.parse(a);h=r;var t={page:v,methode:c,callback:function(a){var r=JSON.parse(a);p=r,e.showPersonnage(h,p)}};new AjaxHome(t)}};new AjaxHome(u)},showPersonnage:function(a,e){if(a.hasOwnProperty("data")){var r=a.data;if(r.hasOwnProperty("results")){var t=r.results[0],n=null,s=null,i="",o=null;t.hasOwnProperty("id")&&(n=t.id.toString()),t.hasOwnProperty("name")&&(s=t.name),t.hasOwnProperty("description")&&sizeOf(t.description>0)&&(i=t.description),t.hasOwnProperty("thumbnail")&&t.thumbnail.hasOwnProperty("path")&&t.thumbnail.hasOwnProperty("extension")&&(o=t.thumbnail.path+"."+t.thumbnail.extension);var v={id:n,nom:s,description:i,image:o}}else console.log("impossible de récupérer les données du personnage")}else console.log("aucune donnée disponible pour ce personnage");if(e.hasOwnProperty("data")){var r=e.data,l=0,c=null;if(r.hasOwnProperty("count")&&(l=r.count.toString()),r.hasOwnProperty("results")){if(Array.isArray(r.results))for(var c=r.results,f=[],h=null,p=null,u=null,m=null,d=null,g=0;g<c.length;g++){var w=c[g];isObject(w)&&(w.hasOwnProperty("id")&&(h=w.id.toString()),w.hasOwnProperty("title")&&(p=w.title),w.hasOwnProperty("description")&&(u=w.description),w.hasOwnProperty("images")&&(m=w.images),w.hasOwnProperty("dates")&&(d=w.dates)),f[g]={id:h,titre:p,description:u,images:m,dates:d}}}else console.log("impossible de récupérer la liste des comics pour ce personnage")}var y={infosPersonnage:v},P={nbComics:l,listeDesComics:f},b=JSON.stringify(y),O=JSON.stringify(P),A="/showCharDetails",D="POST",k={dataPersonnage:b,dataComics:O},I={page:A,methode:D,data:k,headers:[{titre:"Content-type",valeur:"application/x-www-form-urlencoded"}],callback:function(a){var e=getID("cDataPersonnage");e.innerHTML=a}};new AjaxHome(I)},getListPersonnages:function(){var a=this,e="5d62c8396ef3ff66213aeac64e020ce8e51743f8",r="a16d8956cd76927ea53d489bba636c59",t=(new Date).getTime(),n=md5(t+e+r),i={offset:100,limit:22},o=this.generateUrlParams(i),v="http://gateway.marvel.com/v1/public/characters?ts="+t+"&apikey="+r+"&hash="+n+"&"+o,l="GET",f={page:v,methode:l,callback:function(e){var r=JSON.parse(e);a.showListChars(r)}};new AjaxHome(f)},showListChars:function(a){if(a.hasOwnProperty("data")){var e=a.data,r=e.count,n=(e.offset,null),s=null,i="non disponnible",o=[];if(Array.isArray(e.results))for(var v=e.results,l=0;r>l;l++){var c=v[l];if(isObject(c)){var f="inconnu";c.hasOwnProperty("name")&&(f=c.name),c.hasOwnProperty("id")&&(s=c.id),c.hasOwnProperty("thumbnail")&&(n=c.thumbnail.path+"."+c.thumbnail.extension);var h={persID:c.id,nom:c.name,image:n,comics:i};o[l]=h}}for(var p={},l=0;l<o.length;l++){var u=o[l];p["pers"+u.persID]=JSON.stringify(u)}var m=p,d="/getChars",g="POST",w={page:d,methode:g,data:m,headers:[{titre:"Content-type",valeur:"application/x-www-form-urlencoded"}],callback:function(a){var e=getID("cListe");e.innerHTML=a}};new AjaxHome(w)}},generateUrlParams:function(a){var e="",r=sizeOf(a),t=0;for(var n in a){var s=a[n];"function"!=typeof s&&(s.toString().length>0&&"formDocument"!=n&&(e=e+n+"="+s,r-1>t&&(e+="&")),t++)}return e}};